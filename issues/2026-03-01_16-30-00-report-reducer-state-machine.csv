"id","priority","phase","area","title","description","acceptance_criteria","test_mcp","review_initial_requirements","review_regression_requirements","dev_state","review_initial_state","review_regression_state","git_state","owner","refs","notes"
"APRSM-000","P0","1","both","固化重构边界与验收基线","以 Report 第7节为准建立重构边界，限定仅覆盖翻译任务 endpoint 保护链路，不改动 inpaint/scan。","产出可审阅的边界清单并被团队确认；翻译链路外功能回归用例 0 失败；验收口径明确引用 Report 第7节。","AUTOE2E","确认边界文档已包含不改动模块列表、灰度范围与回滚触点。","执行翻译+inpaint+scan 冒烟回归，验证非目标链路行为与重构前一致。","已完成","已完成","已完成","已提交","","D:\A1\mangatype-live\Report.md:7;D:\A1\mangatype-live\plan\2026-03-01_16-30-00-report-reducer-state-machine.md:1;D:\A1\mangatype-live\plan\2026-03-01_16-30-00-report-reducer-state-machine-boundary.md:1","picked_reason:P0 phase1 baseline first to lock scope and avoid non-target regressions;review_initial:boundary doc includes non-target module list, rollout scope and rollback touchpoints;validation_limited:interactive translate/inpaint/scan smoke cannot run in current CLI-only environment;manual_test:1) npm run dev 2) run translate queue and verify protection path 3) run inpaint and scan smoke and confirm behavior unchanged;evidence:added boundary baseline document and npm run build passed;risk:low docs-only and no runtime behavior change;done_at:2026-03-01"
"APRSM-010","P0","2","backend","扩展 APIEndpoint 状态字段与持久化兼容","在 APIEndpoint 模型新增保护状态字段并实现旧配置自动补默认值，保证 localStorage 向后兼容。","旧配置加载无报错；新增字段默认值完整；重复初始化结果幂等；旧用户配置不丢失且可继续翻译。","AUTOSERVER","检查类型定义、序列化/反序列化路径和默认值常量单一来源，禁止散落硬编码。","对含缺失字段、脏字段、完整字段三类样本执行加载回归，确保结果一致且无抖动。","未开始","未开始","未开始","未提交","","D:\A1\mangatype-live\types.ts:1;D:\A1\mangatype-live\contexts\ProjectContext.tsx:1;D:\A1\mangatype-live\plan\2026-03-01_16-30-00-report-reducer-state-machine.md:9",""
"APRSM-020","P0","3","backend","定义统一保护事件协议与失败分类","建立统一事件模型与失败分类枚举，约束停用原因优先级与展示来源，避免多处各自判定。","事件类型全集可被类型系统覆盖；失败分类映射无重叠；停用原因优先级可复现且稳定。","AUTOSERVER","评审事件 schema 的可扩展性与向后兼容，确认未知失败有兜底分类。","构造 HTTP 与解析失败混合场景，验证最终 disable reason 符合优先级规则且稳定。","未开始","未开始","未开始","未提交","","D:\A1\mangatype-live\services\apiProtection.ts:1;D:\A1\mangatype-live\services\geminiService.ts:1;D:\A1\mangatype-live\plan\2026-03-01_16-30-00-report-reducer-state-machine.md:13",""
"APRSM-030","P0","4","backend","实现 reducer 状态机单入口转移","在独立模块实现纯函数 reducer，统一暂停、降并发、恢复、停用状态转移并按批次累计失败。","表驱动单测覆盖关键转移；批次失败仅 +1；首次失败降并发到1；degraded 成功后恢复用户并发并清理计数。","AUTOSERVER","评审 reducer 纯度、无副作用、分支覆盖与可审计日志字段。","注入连续失败/恢复/阈值停用序列，验证状态转移与计数无跳阶和无遗漏。","未开始","未开始","未开始","未提交","","D:\A1\mangatype-live\services\apiProtection.ts:1;D:\A1\mangatype-live\plan\2026-03-01_16-30-00-report-reducer-state-machine.md:17",""
"APRSM-040","P0","5","backend","引入 endpoint 事件队列与 event_seq 门控","为每个 endpoint 建立串行事件消费队列，所有保护更新统一走 dispatch 并按 event_seq 丢弃过期事件。","并发下同 endpoint 无并行写入；过期事件被丢弃且有可观测日志；慢请求回写不再覆盖新状态。","AUTOSERVER","评审队列生命周期、异常处理、内存释放和 endpoint 销毁场景，禁止旁路写状态。","通过乱序返回和延迟注入回归，验证最终状态由最新序号决定且无竞争覆盖。","未开始","未开始","未开始","未提交","","D:\A1\mangatype-live\hooks\useProcessor.ts:1;D:\A1\mangatype-live\services\apiProtection.ts:1;D:\A1\mangatype-live\plan\2026-03-01_16-30-00-report-reducer-state-machine.md:21",""
"APRSM-050","P0","6","both","调度器改造为端点级批次循环","将流式 worker 分派改为 endpoint 组批并在 awaitSettled 后派发批次事件，再决策下一批。","首批10并发全429仅计1次批次失败并触发暂停；二批并发1成功后恢复用户并发；吞吐不低于重构前基线阈值。","AUTOE2E","评审批次边界定义、饥饿风险与吞吐监控指标，确认失败计数语义已从请求级切到批次级。","执行 1 endpoint 并发10与混合成功失败场景，核对计数、暂停时长、恢复行为与性能曲线。","未开始","未开始","未开始","未提交","","D:\A1\mangatype-live\hooks\useProcessor.ts:1;D:\A1\mangatype-live\services\geminiService.ts:1;D:\A1\mangatype-live\plan\2026-03-01_16-30-00-report-reducer-state-machine.md:25",""
"APRSM-060","P1","7","frontend","ProviderTab 展示停用原因与生效并发","将暂停信息与停用原因解耦，停用后常驻显示 disable reason，并展示用户并发与生效并发。","停用后即使 pause 到期也持续显示 disable reason；界面同时显示 user/effective concurrency 且文案清晰。","AUTOFRONTEND","评审文案一致性、状态来源单一化与组件重渲染影响，避免展示与真实状态不一致。","执行停用-到期-手动启用路径 UI 回归，确认展示切换正确且无闪烁。","未开始","未开始","未开始","未提交","","D:\A1\mangatype-live\components\settings\ProviderTab.tsx:1;D:\A1\mangatype-live\types.ts:1;D:\A1\mangatype-live\plan\2026-03-01_16-30-00-report-reducer-state-machine.md:29",""
"APRSM-070","P0","8","both","补齐单元与集成回归测试矩阵","新增 reducer 表驱动单测、批次语义集成验证与 UI 验证，覆盖429与解析失败保护链路。","reducer 关键分支覆盖率达团队阈值；429与 PARSE_BUBBLES_INVALID 都触发同等保护；停用原因展示回归通过。","AUTOE2E","评审测试命名、夹具可复用性与失败可诊断性，避免用例依赖脆弱时序。","执行全量回归并保存基线结果，确认无跨模块回归与无随机失败。","未开始","未开始","未开始","未提交","","D:\A1\mangatype-live\services\apiProtection.ts:1;D:\A1\mangatype-live\components\settings\ProviderTab.tsx:1;D:\A1\mangatype-live\plan\2026-03-01_16-30-00-report-reducer-state-machine.md:33",""
"APRSM-080","P1","9","backend","发布开关与回滚路径落地","增加 apiProtectionStateMachineV2 功能开关用于灰度，提供快速回滚到旧逻辑的可执行路径。","开关可在运行时/配置层生效；灰度启用可观测；回滚后旧字段读取正常且不破坏现有 endpoint 配置。","AUTOSERVER","评审开关默认值、灰度粒度、监控告警和回滚步骤文档完整性。","执行开关开/关与回滚演练，验证数据兼容、服务可用与用户可感知风险可控。","未开始","未开始","未开始","未提交","","D:\A1\mangatype-live\services\apiProtection.ts:1;D:\A1\mangatype-live\contexts\ProjectContext.tsx:1;D:\A1\mangatype-live\plan\2026-03-01_16-30-00-report-reducer-state-machine.md:37",""
